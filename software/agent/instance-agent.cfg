[buildout]
parts =
  instance

eggs-directory = ${buildout:eggs-directory}
develop-eggs-directory = ${buildout:develop-eggs-directory}
offline = true

[directory]
recipe = slapos.cookbook:mkdirectory
etc = $${buildout:directory}/etc
service = $${buildout:directory}/etc/service
run = $${buildout:directory}/etc/run
agentlog = $${buildout:directory}/var/log/agent
srv = $${buildout:directory}/srv
bin = $${buildout:directory}/bin

[instance]
recipe = slapos.cookbook:wrapper
command-line =
  ${buildout:bin-directory}/agent
  --pidfile=$${directory:srv}/agent.pid
  --log=$${directory:agentlog}/agent.log
  $${agent-cfg:output}

wrapper-path = $${directory:service}/agent
output = $${:wrapper-path}

[agent-cfg]
recipe = slapos.recipe.template
url = ${agent.cfg.in:output} 
output = $${directory:etc}/agent.cfg

[user-key]
recipe = slapos.recipe.template
url = ${configuration.template:output} 
output = $${directory:etc}/certificate.key
content = $${slap-parameter:user_key}

[user-certificate]
recipe = slapos.recipe.template
url = ${configuration.template:output}
output = $${directory:etc}/certificate.crt
content = $${slap-parameter:user_certificate}

[slap-parameter]
timeout = 3600 
configuration_url = 
user_key = 
user_certificate = 
master_url = 

node_title = 
test_title = 
project_title = 
task_count = 1 
report_url = 
